<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
			<meta name="viewport" content="width=device-width, initial-scale=1.0">
				<title>Enhanced OL-MCP Local AI Stack Interface</title>
				<link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
					<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
	<body>
		<header>
			<div class="container">
				<div class="header-content" style="display: flex; justify-content: space-between; align-items: center;">
					<div class="header-title" style="display: flex; align-items: center; gap: 20px;">
						<img src="{{ url_for('static', filename='images/logo.png') }}" alt="Local AI Stack Logo" style="
                        width: 64px; height: 64px; border-radius: 12px;
                        background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-light-blue) 100%);
                        padding: 8px; box-shadow: 0 4px 16px rgba(37, 99, 235, 0.2);
                    ">
							<div>
								<h1 style="margin: 0;"> Enhanced (OL-MCP) Local AI Stack </h1>
								<div style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">
									üî• Vector Database ‚Ä¢ Enhanced RAG ‚Ä¢ Real-time Search
								</div>
							</div>
						</div>
					<div class="header-links" style="display: flex; align-items: center; gap: 15px;">
						<a href="http://localhost:3001" target="_blank" style="
                        display: flex; align-items: center; gap: 8px; color: var(--text-primary);
                        text-decoration: none; padding: 8px 12px; border-radius: 5px;
                        border: 1px solid var(--border-color); background: var(--bg-tertiary);
                        transition: all 0.3s; font-size: 0.9rem;
                    " onmouseover="this.style.background='var(--system-accent)'; this.style.borderColor='var(--system-accent)';"
						   onmouseout="this.style.background='var(--bg-tertiary)'; this.style.borderColor='var(--border-color)';">
							<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
								<path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8Z"/>
							</svg>
							Vector DB
						</a>
						<a href="https://github.com/trevino293/local_ai_stack" target="_blank" style="
                        display: flex; align-items: center; gap: 8px; color: var(--text-primary);
                        text-decoration: none; padding: 8px 12px; border-radius: 5px;
                        border: 1px solid var(--border-color); background: var(--bg-tertiary);
                        transition: all 0.3s; font-size: 0.9rem;
                    " onmouseover="this.style.background='var(--accent-blue)'; this.style.borderColor='var(--accent-blue)';"
						   onmouseout="this.style.background='var(--bg-tertiary)'; this.style.borderColor='var(--border-color)';">
							<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
								<path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
							</svg>
							GitHub
						</a>
						<a href="/docs" style="
                        display: flex; align-items: center; gap: 8px; color: var(--text-primary);
                        text-decoration: none; padding: 8px 12px; border-radius: 5px;
                        border: 1px solid var(--border-color); background: var(--bg-tertiary);
                        transition: all 0.3s; font-size: 0.9rem;
                    " onmouseover="this.style.background='var(--accent-blue)'; this.style.borderColor='var(--accent-blue)';"
						   onmouseout="this.style.background='var(--bg-tertiary)'; this.style.borderColor='var(--border-color)';">
							<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
								<path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
							</svg>
							Docs
						</a>
					</div>
				</div>
			</div>
		</header>

		<div class="container">
			<div class="main-grid">
				<!-- Left Panel: Enhanced Model & Vector Database Management -->
				<div class="panel">
					<h2>Model & Configuration</h2>
					<div class="model-header">
						<select id="modelSelect" class="model-select">
							<option value="">Loading models...</option>
						</select>
						<div class="config-button">
							<!-- Configuration dropdown remains the same -->
							<button class="gear-btn" id="configToggle">
								<svg class="gear-icon" viewBox="0 0 24 24" fill="currentColor">
									<path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97c0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1c0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66Z"/>
								</svg>
							</button>
							<!-- Include the existing config dropdown content here -->
						</div>
					</div>

					<!-- Enhanced Processing Mode Controls -->
					<h2>Processing Mode</h2>
					<div class="processing-mode-controls" style="
                    background: linear-gradient(135deg, var(--bg-tertiary) 0%, rgba(139, 92, 246, 0.05) 100%);
                    padding: 15px; border-radius: 8px; border: 1px solid var(--system-accent); margin-bottom: 20px;
                ">
						<div style="display: flex; gap: 8px; margin-bottom: 12px;">
							<button class="mode-btn" id="fastModeBtn" style="
                            flex: 1; padding: 8px 12px; border-radius: 6px; cursor: pointer;
                            font-weight: 500; font-size: 0.85rem; transition: all 0.3s;
                            background: var(--bg-tertiary); color: var(--text-secondary);
                            border: 1px solid var(--border-color);
                        ">‚ö° Fast Mode</button>
							<button class="mode-btn" id="detailedModeBtn" style="
                            flex: 1; padding: 8px 12px; border-radius: 6px; cursor: pointer;
                            font-weight: 500; font-size: 0.85rem; transition: all 0.3s;
                            background: var(--bg-tertiary); color: var(--text-secondary);
                            border: 1px solid var(--border-color);
                        ">üîç Detailed Mode</button>
						</div>
						<div style="font-size: 0.8rem; color: var(--text-secondary); text-align: center;">
							Current: <span id="currentMode" style="color: var(--accent-light-blue); font-weight: 600;">Fast</span>
						</div>
					</div>

					<!-- Enhanced System Status with Vector Database -->
					<h2>Enhanced System Status</h2>
					<div class="status">
						<span class="status-dot" id="ollamaDot"></span>
						<span>
							Ollama: <span id="ollamaStatus">Checking...</span>
						</span>
					</div>
					<div class="status">
						<span class="status-dot" id="mcpDot"></span>
						<span>
							MCP Server: <span id="mcpStatus">Checking...</span>
						</span>
					</div>
					<div class="status">
						<span class="status-dot" id="embeddingDot"></span>
						<span>
							Embedding Service: <span id="embeddingStatus">Checking...</span>
						</span>
					</div>
					<div class="status">
						<span class="status-dot" id="vectordbDot"></span>
						<span>
							Vector Database: <span id="vectordbStatus">Checking...</span>
						</span>
					</div>

					<!-- Enhanced Vector Database Statistics -->
					<h2>Vector Database Analytics</h2>
					<div class="vector-database-stats" style="
                    background: linear-gradient(135deg, var(--bg-tertiary) 0%, rgba(37, 99, 235, 0.05) 100%);
                    padding: 15px; border-radius: 8px; border: 1px solid var(--accent-blue); margin-bottom: 20px;
                ">
						<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; font-size: 0.85rem; margin-bottom: 12px;">
							<div>
								<span style="color: var(--text-secondary);">Database Type:</span>
								<span id="databaseType" style="color: var(--accent-light-blue); font-weight: 600; margin-left: 5px;">Loading...</span>
							</div>
							<div>
								<span style="color: var(--text-secondary);">Status:</span>
								<span id="databaseStatus" style="color: var(--success); font-weight: 600; margin-left: 5px;">Loading...</span>
							</div>
							<div>
								<span style="color: var(--text-secondary);">Total Vectors:</span>
								<span id="totalVectors" style="color: var(--accent-light-blue); font-weight: 600; margin-left: 5px;">0</span>
							</div>
							<div>
								<span style="color: var(--text-secondary);">Indexed Files:</span>
								<span id="indexedFiles" style="color: var(--accent-light-blue); font-weight: 600; margin-left: 5px;">0</span>
							</div>
							<div>
								<span style="color: var(--text-secondary);">Embedding Method:</span>
								<span id="embeddingMethod" style="color: var(--system-accent); font-weight: 600; margin-left: 5px;">Loading...</span>
							</div>
							<div>
								<span style="color: var(--text-secondary);">Collection:</span>
								<span id="collectionName" style="color: var(--system-accent); font-weight: 600; margin-left: 5px;">Loading...</span>
							</div>
						</div>

						<!-- Performance Metrics -->
						<div style="border-top: 1px solid var(--border-color); padding-top: 12px;">
							<div style="color: var(--accent-light-blue); font-weight: 600; font-size: 0.9rem; margin-bottom: 8px;">Performance Metrics</div>
							<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 0.8rem;">
								<div>
									<span style="color: var(--text-secondary);">Avg Search:</span>
									<span id="avgSearchTime" style="color: var(--success); font-weight: 600; margin-left: 5px;">-</span>
								</div>
								<div>
									<span style="color: var(--text-secondary);">Search Count:</span>
									<span id="searchCount" style="color: var(--success); font-weight: 600; margin-left: 5px;">0</span>
								</div>
								<div>
									<span style="color: var(--text-secondary);">Cache Hit Rate:</span>
									<span id="cacheHitRate" style="color: var(--success); font-weight: 600; margin-left: 5px;">0%</span>
								</div>
								<div>
									<span style="color: var(--text-secondary);">Last Vectorization:</span>
									<span id="lastVectorizationTime" style="color: var(--success); font-weight: 600; margin-left: 5px;">-</span>
								</div>
							</div>
						</div>

						<!-- Quick Actions -->
						<div style="border-top: 1px solid var(--border-color); padding-top: 12px; display: flex; gap: 8px;">
							<button id="refreshVectorStatsBtn" style="
                            flex: 1; padding: 6px 12px; background: var(--accent-blue); color: white;
                            border: none; border-radius: 4px; cursor: pointer; font-size: 0.8rem;
                            transition: background 0.3s;
                        " onmouseover="this.style.background='var(--accent-light-blue)'"
							   onmouseout="this.style.background='var(--accent-blue)'">üîÑ Refresh</button>
							<button id="batchVectorizeBtn" style="
                            flex: 1; padding: 6px 12px; background: var(--system-accent); color: white;
                            border: none; border-radius: 4px; cursor: pointer; font-size: 0.8rem;
                            transition: background 0.3s;
                        " onmouseover="this.style.background='rgba(139, 92, 246, 0.8)'"
							   onmouseout="this.style.background='var(--system-accent)'">‚ö° Batch Process</button>
						</div>
					</div>

					<!-- Advanced Search Configuration -->
					<h2>Search Configuration</h2>
					<div class="search-config" style="
                    background: linear-gradient(135deg, var(--bg-tertiary) 0%, rgba(139, 92, 246, 0.05) 100%);
                    padding: 15px; border-radius: 8px; border: 1px solid var(--system-accent); margin-bottom: 20px;
                ">
						<div style="margin-bottom: 12px;">
							<label for="similarityThreshold" style="
                            display: flex; justify-content: space-between; align-items: center;
                            color: var(--text-primary); font-weight: 500; margin-bottom: 6px; font-size: 0.9rem;
                        ">
								Similarity Threshold:
								<span id="similarityThresholdValue" style="color: var(--accent-light-blue); font-weight: 600;">0.30</span>
							</label>
							<input type="range" id="similarityThreshold" min="0.1" max="0.9" step="0.05" value="0.3" style="
                            width: 100%; height: 6px; border-radius: 3px; background: var(--bg-primary);
                            outline: none; margin-bottom: 3px; -webkit-appearance: none;
                        ">
								<small style="color: var(--text-secondary); font-size: 0.75rem;">
									Lower = more results, Higher = more precise
								</small>
							</div>

						<div style="display: flex; align-items: center; gap: 8px;">
							<input type="checkbox" id="advancedSearchEnabled" style="
                            width: 16px; height: 16px; accent-color: var(--system-accent);
                        ">
								<label for="advancedSearchEnabled" style="
                            color: var(--text-primary); font-size: 0.9rem; cursor: pointer;
                        ">Enable advanced filtering</label>
							</div>
					</div>

					<!-- Enhanced File Management -->
					<h2>Enhanced File Management</h2>
					<div class="file-upload">
						<div class="file-input-wrapper">
							<input type="file" id="fileInput" accept=".txt,.md,.json,.csv,.yaml,.yml,.log">
								<label for="fileInput" class="file-input-label">üìÅ Upload & Auto-Vectorize</label>
							</div>
						<div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 8px; text-align: center;">
							Supports: TXT, MD, JSON, CSV, YAML, LOG files
						</div>
					</div>
					<div id="fileList" class="file-list">
						<p>No files uploaded</p>
					</div>
				</div>

				<!-- Center: Enhanced Chat Interface -->
				<div class="panel chat-container">
					<h2>Enhanced Vector RAG Chat Interface</h2>
					<div id="chatMessages" class="chat-messages">
						<div class="message assistant enhanced-message vector-enhanced">
							<div class="message-header">
								<span>Assistant</span>
								<div class="message-metadata">
									<span class="confidence-indicator" style="color: #10b981">
										Confidence: 9/10 (vector-ready)
									</span>
									<span class="vector-database-indicator" style="color: var(--system-accent); font-size: 0.8rem;">
										üìä Vector Database Active
									</span>
									<span class="reasoning-pattern" style="color: var(--system-accent); font-size: 0.8rem;">
										Enhanced-RAG-Pipeline
									</span>
									<span class="timestamp">Ready</span>
								</div>
							</div>
							<div class="message-content">
								Welcome to the Enhanced Local AI Stack with Vector Database! üöÄ

								I now feature a production-grade vector database for lightning-fast semantic search, persistent storage, and advanced RAG capabilities. Upload documents for automatic vectorization, and I'll show you exactly which sources influenced my responses with enhanced confidence scoring, real-time similarity metrics, and transparent reasoning processes!

								Key enhancements: ‚ú® Persistent vector storage ‚ú® Advanced similarity search ‚ú® Real-time performance metrics ‚ú® Enhanced citation tracking ‚ú® Multi-stage reasoning transparency
							</div>

							<!-- Enhanced Welcome Vector Demo -->
							<div class="vectorization-insights enhanced" style="
                            margin-top: 12px; padding: 15px;
                            background: linear-gradient(135deg, var(--bg-primary) 0%, rgba(139, 92, 246, 0.08) 100%);
                            border-radius: 8px; border: 1px solid var(--system-accent);
                        ">
								<div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px; color: var(--system-accent); font-weight: 600; font-size: 0.95rem;">
									<svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
										<path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
									</svg>
									Enhanced Vector Database Ready
								</div>
								<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; font-size: 0.85rem;">
									<div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
										<span style="color: var(--text-secondary); display: block;">Database:</span>
										<span style="color: var(--accent-light-blue); font-weight: 600;">Qdrant/ChromaDB</span>
									</div>
									<div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
										<span style="color: var(--text-secondary); display: block;">Embeddings:</span>
										<span style="color: var(--text-primary); font-weight: 600;">384D Vectors</span>
									</div>
									<div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
										<span style="color: var(--text-secondary); display: block;">Search:</span>
										<span style="color: var(--success); font-weight: 600;">Cosine Similarity</span>
									</div>
									<div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
										<span style="color: var(--text-secondary); display: block;">Mode:</span>
										<span style="color: var(--success); font-weight: 600;">Real-time</span>
									</div>
									<div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
										<span style="color: var(--text-secondary); display: block;">Persistence:</span>
										<span style="color: var(--system-accent); font-weight: 600;">Enabled</span>
									</div>
									<div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
										<span style="color: var(--text-secondary); display: block;">Status:</span>
										<span style="color: var(--success); font-weight: 600;">Active</span>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="chat-input">
						<textarea id="messageInput" placeholder="Ask me anything... I'll use the enhanced vector database to find relevant context and show you my complete reasoning process with real-time similarity metrics! (Ctrl+Enter to send)"></textarea>
						<button id="sendButton">Send</button>
					</div>
				</div>

				<!-- Right Panel: Enhanced Analytics & Performance -->
				<div class="panel">
					<div class="history-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
						<h2 style="margin: 0;">Enhanced Analytics</h2>
						<button id="clearHistoryBtn" style="
                        background: var(--error); color: white; border: none; padding: 6px 12px;
                        border-radius: 4px; cursor: pointer; font-size: 0.8rem; transition: background 0.3s;
                    " onmouseover="this.style.background='#dc2626'" onmouseout="this.style.background='var(--error)'">
							Clear All
						</button>
					</div>

					<!-- Enhanced Conversation Info -->
					<div class="conversation-info" style="
                    background: linear-gradient(135deg, var(--bg-tertiary) 0%, rgba(37, 99, 235, 0.05) 100%);
                    padding: 12px; border-radius: 6px; margin-bottom: 15px; border: 1px solid var(--accent-blue);
                ">
						<div style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 8px;">
							Current Session Status
						</div>
						<div id="conversationStatus" style="font-size: 0.9rem; color: var(--text-primary); margin-bottom: 8px;">
							Enhanced Vector RAG Active
						</div>
						<div style="font-size: 0.8rem; color: var(--accent-light-blue); display: flex; align-items: center; gap: 6px;">
							<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
								<path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8Z"/>
							</svg>
							Vector database pipeline operational
						</div>
					</div>

					<!-- Enhanced Real-time Performance Dashboard -->
					<div class="performance-dashboard" style="
                    background: linear-gradient(135deg, var(--bg-tertiary) 0%, rgba(139, 92, 246, 0.1) 100%);
                    padding: 12px; border-radius: 6px; margin-bottom: 15px; border: 1px solid var(--system-accent);
                ">
						<div style="color: var(--system-accent); font-weight: 600; font-size: 0.9rem; margin-bottom: 8px; display: flex; align-items: center; gap: 6px;">
							<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
								<path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6Z"/>
							</svg>
							Real-time Performance
						</div>
						<div style="display: grid; grid-template-columns: 1fr; gap: 8px; font-size: 0.8rem;">
							<div style="display: flex; justify-content: space-between; padding: 6px 8px; background: var(--bg-primary); border-radius: 4px;">
								<span style="color: var(--text-secondary);">Vector Search Time:</span>
								<span id="realTimeSearchTime" style="color: var(--success); font-weight: 600;">~125ms</span>
							</div>
							<div style="display: flex; justify-content: space-between; padding: 6px 8px; background: var(--bg-primary); border-radius: 4px;">
								<span style="color: var(--text-secondary);">Chunks Per Query:</span>
								<span id="chunksPerQuery" style="color: var(--accent-light-blue); font-weight: 600;">3-5</span>
							</div>
							<div style="display: flex; justify-content: space-between; padding: 6px 8px; background: var(--bg-primary); border-radius: 4px;">
								<span style="color: var(--text-secondary);">Similarity Threshold:</span>
								<span id="currentSimilarityDisplay" style="color: var(--system-accent); font-weight: 600;">0.30</span>
							</div>
							<div style="display: flex; justify-content: space-between; padding: 6px 8px; background: var(--bg-primary); border-radius: 4px;">
								<span style="color: var(--text-secondary);">Response Mode:</span>
								<span id="processingModeIndicator" style="color: var(--success); font-weight: 600;">Fast Mode</span>
							</div>
						</div>
					</div>

					<!-- Enhanced Vector Database Features -->
					<div class="vector-features" style="
                    background: linear-gradient(135deg, var(--bg-tertiary) 0%, rgba(37, 99, 235, 0.05) 100%);
                    padding: 12px; border-radius: 6px; margin-bottom: 15px; border: 1px solid var(--accent-blue);
                ">
						<div style="color: var(--accent-light-blue); font-weight: 600; font-size: 0.9rem; margin-bottom: 8px;">
							üöÄ Vector Database Features
						</div>
						<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 0.8rem;">
							<div style="display: flex; align-items: center; gap: 6px;">
								<span style="color: var(--success);">‚úÖ</span>
								<span style="color: var(--text-primary);">Persistent Storage</span>
							</div>
							<div style="display: flex; align-items: center; gap: 6px;">
								<span style="color: var(--success);">‚úÖ</span>
								<span style="color: var(--text-primary);">Semantic Search</span>
							</div>
							<div style="display: flex; align-items: center; gap: 6px;">
								<span style="color: var(--success);">‚úÖ</span>
								<span style="color: var(--text-primary);">Auto-Vectorization</span>
							</div>
							<div style="display: flex; align-items: center; gap: 6px;">
								<span style="color: var(--success);">‚úÖ</span>
								<span style="color: var(--text-primary);">Similarity Scoring</span>
							</div>
							<div style="display: flex; align-items: center; gap: 6px;">
								<span style="color: var(--success);">‚úÖ</span>
								<span style="color: var(--text-primary);">Batch Processing</span>
							</div>
							<div style="display: flex; align-items: center; gap: 6px;">
								<span style="color: var(--success);">‚úÖ</span>
								<span style="color: var(--text-primary);">Real-time Stats</span>
							</div>
							<div style="display: flex; align-items: center; gap: 6px;">
								<span style="color: var(--success);">‚úÖ</span>
								<span style="color: var(--text-primary);">Citation Tracking</span>
							</div>
							<div style="display: flex; align-items: center; gap: 6px;">
								<span style="color: var(--success);">‚úÖ</span>
								<span style="color: var(--text-primary);">Performance Metrics</span>
							</div>
						</div>
					</div>

					<!-- Live Similarity Metrics -->
					<div class="similarity-metrics" style="
                    background: var(--bg-tertiary); padding: 12px; border-radius: 6px; margin-bottom: 15px; border: 1px solid var(--border-color);
                ">
						<div style="color: var(--text-primary); font-weight: 600; font-size: 0.9rem; margin-bottom: 8px;">
							üìä Live Similarity Metrics
						</div>
						<div style="display: flex; flex-direction: column; gap: 6px; font-size: 0.8rem;">
							<div style="display: flex; justify-content: space-between;">
								<span style="color: var(--text-secondary);">Average Similarity:</span>
								<span id="avgSimilarity" style="color: var(--accent-light-blue); font-weight: 600;">0.000</span>
							</div>
							<div style="display: flex; justify-content: space-between;">
								<span style="color: var(--text-secondary);">Last Search Time:</span>
								<span id="searchTime" style="color: var(--success); font-weight: 600;">-</span>
							</div>
							<div style="display: flex; justify-content: space-between;">
								<span style="color: var(--text-secondary);">Vector Database:</span>
								<span id="activeDatabaseType" style="color: var(--system-accent); font-weight: 600;">Loading...</span>
							</div>
						</div>
					</div>

					<!-- Enhanced Chat History -->
					<h3 style="color: var(--accent-light-blue); margin-bottom: 10px; font-size: 1rem;">Enhanced Chat History</h3>
					<div id="historyList" class="history-list">
						<p>No chat history yet</p>
					</div>
				</div>
			</div>
		</div>

		<!-- Enhanced Footer with Vector Database Info -->
		<footer style="
        background: var(--bg-secondary); border-top: 1px solid var(--border-color);
        margin-top: 40px; padding: 30px 0;
    ">
			<div class="container">
				<div style="
                display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 30px; margin-bottom: 20px;
            ">
					<!-- About Section -->
					<div>
						<h3 style="color: var(--accent-light-blue); margin-bottom: 15px; font-size: 1.1rem;">Enhanced Local AI Stack</h3>
						<p style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.6;">
							Production-grade AI chat interface with vector database integration, persistent semantic search,
							and advanced RAG capabilities. Built for enterprise performance with complete local control.
						</p>
					</div>

					<!-- Enhanced Features Section -->
					<div>
						<h3 style="color: var(--accent-light-blue); margin-bottom: 15px; font-size: 1.1rem;">Vector Database Features</h3>
						<ul style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.6; padding-left: 20px;">
							<li>Qdrant/ChromaDB Integration</li>
							<li>Persistent Vector Storage</li>
							<li>Real-time Semantic Search</li>
							<li>Advanced Similarity Metrics</li>
							<li>Batch Document Processing</li>
							<li>Performance Analytics</li>
						</ul>
					</div>

					<!-- Links Section -->
					<div>
						<h3 style="color: var(--accent-light-blue); margin-bottom: 15px; font-size: 1.1rem;">Resources</h3>
						<div style="display: flex; flex-direction: column; gap: 8px;">
							<a href="/docs" style="
                            color: var(--text-secondary); text-decoration: none; font-size: 0.9rem;
                            display: flex; align-items: center; gap: 8px; transition: color 0.3s;
                        " onmouseover="this.style.color='var(--accent-light-blue)'"
							   onmouseout="this.style.color='var(--text-secondary)'">
								<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
									<path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
								</svg>
								Enhanced Documentation
							</a>
							<a href="http://localhost:3001" target="_blank" style="
                            color: var(--text-secondary); text-decoration: none; font-size: 0.9rem;
                            display: flex; align-items: center; gap: 8px; transition: color 0.3s;
                        " onmouseover="this.style.color='var(--accent-light-blue)'"
							   onmouseout="this.style.color='var(--text-secondary)'">
								<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
									<path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8Z"/>
								</svg>
								Vector Database UI
							</a>
							<a href="https://github.com/trevino293/local_ai_stack" target="_blank" style="
                            color: var(--text-secondary); text-decoration: none; font-size: 0.9rem;
                            display: flex; align-items: center; gap: 8px; transition: color 0.3s;
                        " onmouseover="this.style.color='var(--accent-light-blue)'"
							   onmouseout="this.style.color='var(--text-secondary)'">
								<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
									<path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
								</svg>
								GitHub Repository
							</a>
						</div>
					</div>
				</div>

				<!-- Enhanced Footer Bottom -->
				<div style="
                border-top: 1px solid var(--border-color); padding-top: 20px;
                display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;
            ">
					<div style="color: var(--text-secondary); font-size: 0.85rem;">
						¬© 2025 Enhanced (OL-MCP) Local AI Stack with Vector Database. Licensed under MIT.
					</div>
					<div style="
                    display: flex; align-items: center; gap: 15px; color: var(--text-secondary); font-size: 0.85rem;
                ">
						<span>Powered by</span>
						<div style="display: flex; align-items: center; gap: 12px;">
							<span style="
                            background: var(--bg-tertiary); padding: 4px 8px; border-radius: 4px;
                            font-weight: 500; color: var(--accent-light-blue);
                        ">Qdrant</span>
							<span style="
                            background: var(--bg-tertiary); padding: 4px 8px; border-radius: 4px;
                            font-weight: 500; color: var(--accent-light-blue);
                        ">Flask</span>
							<span style="
                            background: var(--bg-tertiary); padding: 4px 8px; border-radius: 4px;
                            font-weight: 500; color: var(--accent-light-blue);
                        ">Ollama</span>
							<span style="
                            background: var(--bg-tertiary); padding: 4px 8px; border-radius: 4px;
                            font-weight: 500; color: var(--accent-light-blue);
                        ">Docker</span>
						</div>
					</div>
				</div>
			</div>
		</footer>

		<!-- Enhanced JavaScript with Vector Database Support -->
		<script>
			// Enhanced similarity threshold slider handler
			document.addEventListener('DOMContentLoaded', function() {
			const similaritySlider = document.getElementById('similarityThreshold');
			const similarityValue = document.getElementById('similarityThresholdValue');
			const currentSimilarityDisplay = document.getElementById('currentSimilarityDisplay');

			if (similaritySlider && similarityValue) {
			similaritySlider.addEventListener('input', function() {
			const value = parseFloat(this.value).toFixed(2);
			similarityValue.textContent = value;
			if (currentSimilarityDisplay) {
			currentSimilarityDisplay.textContent = value;
			}
			});
			}

			// Initialize database type display
			const activeDatabaseType = document.getElementById('activeDatabaseType');
			if (activeDatabaseType) {
			activeDatabaseType.textContent = 'Qdrant'; // Default, will be updated by main.js
			}
			});

			// Global function to handle deliberation toggle (enhanced)
			function toggleDeliberation(button) {
			const content = button.closest('.deliberation-section').querySelector('.deliberation-content');
			const icon = button.querySelector('.chevron-icon');

			content.classList.toggle('collapsed');
			icon.style.transform = content.classList.contains('collapsed') ? '' : 'rotate(180deg)';
			}
		</script>
		<script src="{{ url_for('static', filename='js/main.js') }}"></script>
	</body>
</html>